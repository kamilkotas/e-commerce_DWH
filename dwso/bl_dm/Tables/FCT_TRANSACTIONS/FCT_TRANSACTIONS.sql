CREATE TABLE IF NOT EXISTS bl_dm.FCT_TRANSACTIONS (
					products_surr_id		BIGINT NOT NULL,
					employees_surr_id		BIGINT NOT NULL,
					channels_surr_id		BIGINT NOT NULL,
					promotions_surr_id		BIGINT NOT NULL,
					shops_surr_id			BIGINT NOT NULL,
					customers_surr_id		BIGINT NOT NULL,
					costs 					NUMERIC(10, 2),
					price					NUMERIC(10, 2),
					transaction_id			VARCHAR(255),
					quntity					INTEGER,
					date_id					BIGINT NOT NULL,
					CONSTRAINT transaction_shop_id_id_fkey FOREIGN KEY (shops_surr_id) REFERENCES bl_dm.dim_shops(shops_surr_id),
					CONSTRAINT transaction_promotion_id_fkey FOREIGN KEY (promotions_surr_id) REFERENCES bl_dm.dim_promotions_scd(promotions_surr_id),
					CONSTRAINT transaction_customer_id_fkey FOREIGN KEY (customers_surr_id) REFERENCES bl_dm.dim_customers(customers_surr_id),
					CONSTRAINT transaction_employee_id_fkey FOREIGN KEY (employees_surr_id) REFERENCES bl_dm.dim_employees(employees_surr_id),
					CONSTRAINT transaction_channel_id_fkey FOREIGN KEY (channels_surr_id) REFERENCES bl_dm.dim_channels(channels_surr_id),
					CONSTRAINT transaction_product_id_fkey FOREIGN KEY (products_surr_id) REFERENCES bl_dm.dim_products(products_surr_id),
					CONSTRAINT transaction_date_id_fkey FOREIGN KEY (date_id) REFERENCES bl_dm.dim_dates(date_id)
) PARTITION BY RANGE (date_id);



CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m01 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20210101') TO ('20210201');
  
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m02 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20210201') TO ('20210301');

CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m03 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20210301') TO ('20210401');

CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m04 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20210401') TO ('20210501');

CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m05 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20210501') TO ('20210601');
   
 CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m06 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20210601') TO ('20210701');
   
 CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m07 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20210701') TO ('20210801');
   
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m08 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20210801') TO ('20210901');
   
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m09 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20210901') TO ('20211001');

CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m10 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20211001') TO ('20211101');
   
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m11 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20211101') TO ('20211201');
   
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2021m12 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20211201') TO ('20220101');
-- year 2022  
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m01 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20220101') TO ('20220201');
  
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m02 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20220201') TO ('20220301');

CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m03 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20220301') TO ('20220401');

CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m04 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20220401') TO ('20220501');

CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m05 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20220501') TO ('20220601');
   
 CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m06 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20220601') TO ('20220701');
   
 CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m07 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20220701') TO ('20220801');
   
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m08 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20220801') TO ('20220901');
   
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m09 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20220901') TO ('20221001');

CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m10 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20221001') TO ('20221101');
   
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m11 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20221101') TO ('20221201');
   
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2022m12 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20221201') TO ('20230101');
   
-- year 2023
   
CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2023m01 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20230101') TO ('20230201');
   
 CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2023m02 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20230201') TO ('20230301');
   
 CREATE TABLE bl_dm.FCT_TRANSACTIONS_y2023m03 PARTITION OF bl_dm.FCT_TRANSACTIONS
    FOR VALUES FROM ('20230301') TO ('20230401');